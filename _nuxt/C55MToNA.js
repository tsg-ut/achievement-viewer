import{r as W,g as _,_ as X}from"./r4HLICKF.js";import{r as Z,a as $,b as ee,d as f,s as se}from"./Oy1mHr56.js";import{g as B}from"./Cpj98o6Y.js";import{_ as w,c as u,o as a,a as t,I as p,z as te,x as D,B as h,t as g,F as v,C as y,d as z,y as S,A as re,b as ne}from"./DH_16u3E.js";import"./CdjJNdvM.js";var x,Y;function ie(){if(Y)return x;Y=1;function s(e){return e&&e.length?e[0]:void 0}return x=s,x}var A,L;function oe(){return L||(L=1,A=ie()),A}var ae=oe();const le=B(ae);var k,H;function ue(){if(H)return k;H=1;var s=Z();function e(i,l,n){l=="__proto__"&&s?s(i,l,{configurable:!0,enumerable:!0,value:n,writable:!0}):i[l]=n}return k=e,k}var q,M;function ce(){if(M)return q;M=1;function s(e,i,l,n){for(var r=-1,m=e==null?0:e.length;++r<m;){var c=e[r];i(n,c,l(c),e)}return n}return q=s,q}var T,Q;function ge(){if(Q)return T;Q=1;var s=$();function e(i,l,n,r){return s(i,function(m,c,o){l(r,m,n(m),o)}),r}return T=e,T}var P,R;function me(){if(R)return P;R=1;var s=ce(),e=ge(),i=ee(),l=W();function n(r,m){return function(c,o){var d=l(c)?s:e,b=m?m():{};return d(c,r,i(o,2),b)}}return P=n,P}var C,j;function de(){if(j)return C;j=1;var s=ue(),e=me(),i=Object.prototype,l=i.hasOwnProperty,n=e(function(r,m,c){l.call(r,c)?r[c].push(m):s(r,c,[m])});return C=n,C}var he=de();const pe=B(he);var I,E;function fe(){if(E)return I;E=1;function s(e){var i=e==null?0:e.length;return i?e[i-1]:void 0}return I=s,I}var _e=fe();const ve=B(_e),ye="rotate",we="beat",be="shake",G={computed:{ionClass(){let s="";return this.animate===ye?s="ion-rotate ":this.animate===we?s="ion-beat ":this.animate===be&&(s="ion-shake "),`${this.rootClass} ${s}`}},props:{title:{type:String,default:""},rootClass:{type:String,default:""},w:{type:String,default:"1em"},h:{type:String,default:"1em"},animate:{type:String,default:""}}},xe={name:"ios-arrow-down-icon",mixins:[G],data(){return{iconTitle:this.title?this.title:"Ios Arrow Down Icon"}}},Ae=["data-title"],ke=["width","height"];function qe(s,e,i,l,n,r){return a(),u("div",{class:p(["ion",s.ionClass]),"data-title":n.iconTitle,"data-name":"ios-arrow-down-icon"},[(a(),u("svg",{width:s.w,height:s.h,class:"ion__svg",viewBox:"0 0 512 512"},[...e[0]||(e[0]=[t("path",{d:"M256 294.1L383 167c9.4-9.4 24.6-9.4 33.9 0s9.3 24.6 0 34L273 345c-9.1 9.1-23.7 9.3-33.1.7L95 201.1c-4.7-4.7-7-10.9-7-17s2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l127.1 127z"},null,-1)])],8,ke))],10,Ae)}const Te=w(xe,[["render",qe]]),Pe={name:"ios-arrow-up-icon",mixins:[G],data(){return{iconTitle:this.title?this.title:"Ios Arrow Up Icon"}}},Ce=["data-title"],Ie=["width","height"];function Se(s,e,i,l,n,r){return a(),u("div",{class:p(["ion",s.ionClass]),"data-title":n.iconTitle,"data-name":"ios-arrow-up-icon"},[(a(),u("svg",{width:s.w,height:s.h,class:"ion__svg",viewBox:"0 0 512 512"},[...e[0]||(e[0]=[t("path",{d:"M256 217.9L383 345c9.4 9.4 24.6 9.4 33.9 0 9.4-9.4 9.3-24.6 0-34L273 167c-9.1-9.1-23.7-9.3-33.1-.7L95 310.9c-4.7 4.7-7 10.9-7 17s2.3 12.3 7 17c9.4 9.4 24.6 9.4 33.9 0l127.1-127z"},null,-1)])],8,Ie))],10,Ce)}const Be=w(Pe,[["render",Se]]),Ue=(s,e)=>{if(s.question.split("/").length>=5)return{text:"",invisibleCharacters:0};const i=Array.from(s.question);let l="",n=0,r=!1,m=0;for(const c of i)n>=e?(n++,m++):(l+=c,r?c==="】"&&(r=!1):c==="【"?r=!0:n++);return{text:l,invisibleCharacters:m}},V=(s,e)=>{if(s.question.split("/").length>=5){const c=s.question.split("/"),o=c.slice(0,e),d=c.slice(e),b=o.join(""),F=d.map((N,O)=>Array.from(N).map((U,K,J)=>O===d.length-1&&K===J.length-1&&["。","？","?"].includes(U)?U:"◯").join("​")).join("/");return`${b}​${F}`}const i=Array.from(s.question),l=i[i.length-1],{text:n,invisibleCharacters:r}=Ue(s,e),m=Array(r).fill("").map((c,o)=>o===r-1&&["。","？","?"].includes(l)?l:"◯").join("​");return`${n}​${m}`},De=s=>{if(s.question.split("/").length>=5)return s.question.split("/").length;const e=s.question.replaceAll(/【.*?】/g,"");return Array.from(e).length},ze={components:{ArrowDownIcon:Te,ArrowUpIcon:Be},props:{game:{type:Object,required:!0},progressType:{type:String,required:!0}},data(){return{progress:1,isAnswerPanelShown:!1}},computed:{...te("slackInfos",["getUser"]),questionText(){return V(this.game,this.progress)},maxProgress(){return De(this.game)},formattedStartDate(){return f(this.game.startDate).format("YYYY年M月D日")},formattedStartTime(){return f(this.game.startDate).format("YYYY-MM-DD HH:mm:ss")},formattedRegistrationTime(){return f(this.game.registrationDate).format("YYYY-MM-DD HH:mm:ss")},formattedFinishTime(){return f(this.game.finishDate).format("YYYY-MM-DD HH:mm:ss")},formattedGenre(){return this.game.genre==="normal"?"正統派":this.game.genre==="strange"?"変化球":this.game.genre==="anything"?"なんでも":"不明"},timelineChunks(){const s=[...this.game.comments.map(i=>({...i,type:"comment"})),...this.game.correctAnswers.map(i=>({...i,type:"correctAnswer"})),...this.game.wrongAnswers.map(i=>({...i,type:"wrongAnswer"}))],e=se(Object.entries(pe(s,i=>i.days)),([i])=>parseInt(i));for(const[,i]of e)i.sort((l,n)=>(l.date||0)-(n.date||0));return e}},watch:{progressType(s){if(s==="first"&&this.gotoProgress(1),s==="first-answer"){const e=le(this.game.correctAnswers);this.gotoProgress(e?e.progress:1)}if(s==="last-answer"){const e=ve(this.game.correctAnswers);this.gotoProgress(e?e.progress:1)}s==="last"&&this.gotoProgress(this.maxProgress)}},methods:{incrementProgress(){this.progress<this.maxProgress&&this.progress++},decrementProgress(){this.progress>1&&this.progress--},gotoProgress(s){this.progress=s},getUserName(s){const e=this.getUser(s);return`@${_(e,["profile","display_name"],!1)||_(e,["real_name"],!1)||"匿名ユーザー"}`},getUserIcon(s){const e=this.getUser(s);return _(e,["profile","image_24"],"/images/anonymous-icon_24.png")},getUserIcon2x(s){const e=this.getUser(s);return _(e,["profile","image_48"],"/images/anonymous-icon_48.png")},formatTime(s){return f(s||0).format("HH:mm:ss")},getQuestionText(s){return V(this.game,s)}}},Ye={class:"SlowQuizGame box"},Le={class:"pagination",role:"navigation","aria-label":"pagination"},He={class:"pagination-list"},Me={key:0},Qe={key:1},Re={key:2},je={class:"pagination-link is-current"},Ee={key:3},Ve={key:4},Ge={key:5},Fe={class:"is-size-3 has-text-weight-bold question-text"},Ne={class:"has-text-grey has-text-right is-size-6"},Oe={class:"correct-answers"},Ke=["src","srcset"],Je=["onClick"],We={class:"card game-answer"},Xe={type:"button",class:"card-header-icon"},Ze={class:"icon"},$e={key:0,class:"card-content"},es={class:"content"},ss={class:"is-size-3 has-text-weight-bold question-text"},ts={class:"is-size-3 has-text-weight-bold question-text"},rs={class:"has-text-success has-background-success-light"},ns={class:"pt-1"},is={key:0},os={class:"timeline"},as={class:"timeline-header-wrapper"},ls={class:"timeline-header"},us={class:"tag is-primary"},cs={class:"has-text-grey-light is-size-7"},gs={class:"timeline-marker is-warning is-image is-32x32"},ms=["src","srcset"],ds={class:"timeline-content"},hs={class:"heading"},ps={key:0,class:"tag is-danger"};function fs(s,e,i,l,n,r){const m=D("arrow-up-icon"),c=D("arrow-down-icon");return a(),u("div",Ye,[t("nav",Le,[t("a",{class:p(["pagination-previous",{"is-disabled":n.progress===1}]),onClick:e[0]||(e[0]=(...o)=>r.decrementProgress&&r.decrementProgress(...o))}," 1文字減らす ",2),t("a",{class:p(["pagination-next",{"is-disabled":n.progress===r.maxProgress}]),onClick:e[1]||(e[1]=(...o)=>r.incrementProgress&&r.incrementProgress(...o))}," 1文字増やす ",2),t("ul",He,[n.progress>=3?(a(),u("li",Me,[t("a",{class:"pagination-link",onClick:e[2]||(e[2]=o=>r.gotoProgress(1))}," 1 ")])):h("",!0),n.progress>=4?(a(),u("li",Qe,[...e[7]||(e[7]=[t("span",{class:"pagination-ellipsis"},"…",-1)])])):h("",!0),n.progress>=2?(a(),u("li",Re,[t("a",{class:"pagination-link",onClick:e[3]||(e[3]=o=>r.gotoProgress(n.progress-1))},g(n.progress-1),1)])):h("",!0),t("li",null,[t("a",je,g(n.progress),1)]),n.progress<=r.maxProgress-1?(a(),u("li",Ee,[t("a",{class:"pagination-link",onClick:e[4]||(e[4]=o=>r.gotoProgress(n.progress+1))},g(n.progress+1),1)])):h("",!0),n.progress<=r.maxProgress-3?(a(),u("li",Ve,[...e[8]||(e[8]=[t("span",{class:"pagination-ellipsis"},"…",-1)])])):h("",!0),n.progress<=r.maxProgress-2?(a(),u("li",Ge,[t("a",{class:"pagination-link",onClick:e[5]||(e[5]=o=>r.gotoProgress(r.maxProgress))},g(r.maxProgress),1)])):h("",!0)])]),t("h2",Fe,g(r.questionText),1),t("p",Ne,g(r.getUserName(i.game.author))+" の問題 / "+g(r.formattedStartDate)+"出題 / ジャンル: "+g(r.formattedGenre),1),t("ol",Oe,[(a(!0),u(v,null,y(i.game.correctAnswers,o=>(a(),u("li",{key:o.user},[t("img",{class:"answer-icon",src:r.getUserIcon(o.user),srcset:`${r.getUserIcon(o.user)} 1x, ${r.getUserIcon2x(o.user)} 2x`},null,8,Ke),z(" "+g(r.getUserName(o.user))+" ("+g(o.progress)+"文字) ",1),t("a",{class:"button is-small",onClick:()=>r.gotoProgress(o.progress)}," ここまで表示 ",8,Je)]))),128))]),t("div",We,[t("header",{class:"card-header",onClick:e[6]||(e[6]=o=>n.isAnswerPanelShown=!n.isAnswerPanelShown)},[e[9]||(e[9]=t("p",{class:"card-header-title"}," 正解を表示する ",-1)),t("button",Xe,[t("span",Ze,[n.isAnswerPanelShown?(a(),S(m,{key:0})):(a(),S(c,{key:1}))])])]),n.isAnswerPanelShown?(a(),u("div",$e,[t("div",es,[t("div",ss," Q. "+g(i.game.question),1),t("div",ts,[e[10]||(e[10]=z(" A. ",-1)),t("span",rs,g(i.game.answer),1)]),t("p",ns,"読み: "+g(i.game.ruby),1),i.game.hint!==null?(a(),u("p",is,"ヒント: "+g(i.game.hint),1)):h("",!0),e[12]||(e[12]=t("hr",null,null,-1)),t("div",os,[(a(!0),u(v,null,y(r.timelineChunks,o=>(a(),u("div",{key:o[0]},[t("div",as,[t("header",ls,[t("span",us,g(o[0])+"日目",1)]),t("div",cs,g(r.getQuestionText(o[1][0].progress)),1)]),(a(!0),u(v,null,y(o[1],d=>(a(),u("div",{key:d.date,class:"timeline-item"},[t("div",gs,[t("img",{src:r.getUserIcon(d.user),srcset:`${r.getUserIcon(d.user)} 1x, ${r.getUserIcon2x(d.user)} 2x`},null,8,ms)]),t("div",ds,[t("p",hs,g(r.formatTime(d.date)),1),t("p",{class:p({"has-text-info":d.type==="comment"})},[t("span",{class:p({"has-text-weight-bold":d.type!=="comment"})},g(d.answer),3),d.type==="correctAnswer"?(a(),u("span",ps,"正解")):h("",!0)],2)])]))),128))]))),128)),e[11]||(e[11]=t("header",{class:"timeline-header"},[t("span",{class:"tag is-medium is-primary"},"回答終了")],-1))]),t("ul",null,[t("li",null,"問題登録: "+g(r.formattedRegistrationTime),1),t("li",null,"出題: "+g(r.formattedStartTime),1),t("li",null,"回答終了: "+g(r.formattedFinishTime),1)])])])):h("",!0)])])}const _s=Object.assign(w(ze,[["render",fs]]),{__name:"SlowQuizGame"}),vs={data(){return{isLoading:!0,progressType:"none"}},async fetch({store:s}){},head(){return{title:"1日1文字クイズログ - achievement-viewer"}},computed:{...re({games:s=>s.slowQuizGames.list})},mounted(){Promise.all([this.$store.dispatch("slowQuizGames/initList"),this.$store.dispatch("slackInfos/initUsers")]).then(()=>{this.isLoading=!1})}},ys={class:"container is-max-desktop"},ws={key:0,class:"progress is-small is-primary",max:"100"},bs={class:"control is-flex"},xs={class:"buttons are-small"};function As(s,e,i,l,n,r){const m=X,c=_s;return a(),u("div",ys,[n.isLoading?(a(),u("progress",ws)):h("",!0),ne(m),e[5]||(e[5]=t("p",{class:"title"},"1日1文字クイズログ",-1)),t("div",bs,[e[4]||(e[4]=t("div",{class:"control-label"},"一括操作",-1)),t("div",xs,[t("button",{type:"button",class:"button is-primary is-outlined",onClick:e[0]||(e[0]=o=>n.progressType="first")}," 1文字目のみ表示 "),t("button",{type:"button",class:"button is-primary is-outlined",onClick:e[1]||(e[1]=o=>n.progressType="first-answer")}," 最初の正解者まで表示 "),t("button",{type:"button",class:"button is-primary is-outlined",onClick:e[2]||(e[2]=o=>n.progressType="last-answer")}," 最後の正解者まで表示 "),t("button",{type:"button",class:"button is-primary is-outlined",onClick:e[3]||(e[3]=o=>n.progressType="last")}," 最後まで表示 ")])]),(a(!0),u(v,null,y(s.games,o=>(a(),S(c,{key:o.id,game:o,"progress-type":n.progressType},null,8,["game","progress-type"]))),128))])}const Is=w(vs,[["render",As]]);export{Is as default};
