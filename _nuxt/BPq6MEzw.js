import{g,_ as U}from"./C0f7Tlc7.js";import{g as I,_ as L}from"./UQjbCWGr.js";import{_ as R}from"./DzDXUhIq.js";import{_ as q,A as N,c as a,B as v,b as d,a as s,d as m,t as o,F as S,C as b,P as _,o as c,w as C,J as $}from"./BoHz9PWI.js";import{g as A}from"./Cpj98o6Y.js";import{r as F}from"./CdjJNdvM.js";var f,w;function V(){if(w)return f;w=1;function t(e,l){for(var r,h=-1,n=e.length;++h<n;){var u=l(e[h]);u!==void 0&&(r=r===void 0?u:r+u)}return r}return f=t,f}var p,B;function z(){if(B)return p;B=1;var t=V(),e=F();function l(r){return r&&r.length?t(r,e):0}return p=l,p}var E=z();const J=A(E),P={data(){return{isLoading:!0}},async fetch({store:t}){},head(){return{title:`${this.name}の解除した実績一覧 - achievement-viewer`}},computed:{...N({achievementData:t=>t.achievementData.list}),user(){return this.$store.getters["users/getById"]((this._.provides[_]||this.$route).params.id)},slackUser(){return this.$store.getters["slackInfos/getUser"]((this._.provides[_]||this.$route).params.id)},achievementCount(){return J(Object.values(this.user.counts||{}))},name(){return`@${g(this.slackUser,["profile","display_name"],!1)||g(this.slackUser,["real_name"],!1)||"匿名ユーザー"}`},achievements(){return this.$store.getters["achievements/getByUser"]((this._.provides[_]||this.$route).params.id).map(({name:t,date:e})=>({name:t,date:e,datum:this.$store.getters["achievementData/getById"](t)})).sort((t,e)=>t.datum.difficulty&&e.datum.difficulty?this.getDifficultyRank(e.datum.difficulty)-this.getDifficultyRank(t.datum.difficulty):0)},lockedAchievements(){const t=new Set(this.$store.getters["achievements/getByUser"]((this._.provides[_]||this.$route).params.id).map(({name:e})=>e));return this.achievementData.filter(({id:e})=>!t.has(e)).sort((e,l)=>e.category&&l.category?e.category.localeCompare(l.category):0)},icon(){return g(this.slackUser,["profile","image_72"],"/images/anonymous-icon_72.png")},icon2x(){return g(this.slackUser,["profile","image_192"],"/images/anonymous-icon_192.png")}},mounted(){Promise.all([this.$store.dispatch("achievementData/initList"),this.$store.dispatch("slackInfos/initUsers"),this.$store.dispatch("users/bindById",(this._.provides[_]||this.$route).params.id),this.$store.dispatch("users/initList")]).then(()=>{this.isLoading=!1})},methods:{getCategoryColor(t){return I(t)},getDifficultyRank(t){return{baby:1,easy:2,medium:3,hard:4,professional:5}[t]||0},getDateString(t){return new Date(t.seconds*1e3).toISOString().split("T")[0]},getDateStringJa(t){const e=new Date(t.seconds*1e3);return`${e.getFullYear()}年${e.getMonth()+1}月${e.getDate()}日`}}},j={class:"container"},O={key:0,class:"progress is-small is-primary",max:"100"},T={class:"columns has-text-centered"},M={class:"column is-narrow"},Y=["src","srcset"],G={class:"column"},H={class:"title user-title"},K={class:"columns is-multiline"},Q={class:"card-image"},W={class:"card-content"},X={class:"content"},Z={class:"title"},ee={key:0,class:"columns"},se={class:"column achievements-progress"},te=["value","max"],ie={class:"column is-narrow"},ne={class:"subtitle is-6 achievements-count"},re={class:"has-text-right is-size-7"},oe=["datetime"],ae={class:"columns is-multiline"},ce={class:"card-image"},le={class:"card-content"},ue={class:"content"},de={class:"title"},me={key:0,class:"columns"},_e={class:"column achievements-progress"},he=["value","max"],ge={class:"column is-narrow"},ve={class:"subtitle is-6 achievements-count"};function fe(t,e,l,r,h,n){const u=U,y=L,k=R;return c(),a("div",j,[h.isLoading?(c(),a("progress",O,"15%")):v("",!0),d(u),s("div",T,[s("div",M,[s("img",{src:n.icon,srcset:`${n.icon} 1x, ${n.icon2x} 2x`},null,8,Y)]),s("div",G,[s("p",H,[m(o(n.name)+"の",1),e[0]||(e[0]=s("wbr",null,null,-1)),e[1]||(e[1]=m("解除した",-1)),e[2]||(e[2]=s("wbr",null,null,-1)),e[3]||(e[3]=m("実績一覧",-1))])])]),s("div",K,[(c(!0),a(S,null,b(n.achievements,({datum:i,name:x,date:D})=>(c(),a("div",{key:x,class:"column is-one-third"},[d(k,{class:"card",to:`/achievements/${x}`,style:{display:"block"}},{default:C(()=>[s("div",Q,[s("div",{class:"image achievements-color",style:$({backgroundColor:n.getCategoryColor(i.category)})},null,4)]),s("div",W,[s("div",X,[s("p",Z,[m(o(i.title)+" ",1),d(y,{difficulty:i.difficulty},null,8,["difficulty"])]),i.counter?(c(),a("div",ee,[s("div",se,[s("progress",{class:"progress is-success",value:n.user[i.counter]||0,max:i.value},null,8,te)]),s("div",ie,[s("p",ne,o(i.value)+"/"+o(i.value),1)])])):v("",!0),s("p",null,o(i.condition),1),s("p",re,[s("time",{datetime:n.getDateString(D)},o(n.getDateStringJa(D)),9,oe)])])])]),_:2},1032,["to"])]))),128))]),e[5]||(e[5]=s("p",{class:"title"},"未解除の実績一覧",-1)),s("div",ae,[(c(!0),a(S,null,b(n.lockedAchievements,i=>(c(),a("div",{key:i.id,class:"column is-one-third"},[d(k,{class:"card",to:`/achievements/${i.id}`,style:{display:"block"}},{default:C(()=>[s("div",ce,[s("div",{class:"image achievements-color",style:$({backgroundColor:n.getCategoryColor(i.category)})},null,4)]),s("div",le,[s("div",ue,[s("p",de,[e[4]||(e[4]=m(" ?????? ",-1)),d(y,{difficulty:i.difficulty},null,8,["difficulty"])]),i.counter?(c(),a("div",me,[s("div",_e,[s("progress",{class:"progress is-gray",value:n.user[i.counter]||0,max:i.value},null,8,he)]),s("div",ge,[s("p",ve,o(n.user[i.counter]||0)+"/"+o(i.value),1)])])):v("",!0),s("p",null,o(i.condition),1)])])]),_:2},1032,["to"])]))),128))])])}const be=q(P,[["render",fe]]);export{be as default};
